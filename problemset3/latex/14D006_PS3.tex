\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ...
%\geometry{landscape}                		% Activate for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or eps§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex
								\usepackage[bb=boondox]{mathalfa}
\usepackage{mathtools}
\usepackage{amssymb}

\usepackage{amsmath,amsfonts,amsthm} % Math packages
\usepackage{bm}
\usepackage{graphicx}
\usepackage{dsfont}
\graphicspath{ {images/} }

%SetFonts

%SetFonts

\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} % Create horizontal rule command with 1 argument of height

\title{
\normalfont \normalsize
\textsc{14D006 Stochastic Models and Optimization} \\ [25pt] % Your university, school and/or department name(s)
\horrule{0.5pt} \\[0.4cm] % Thin top horizontal rule
\huge Problemset 3\\ % The assignment title
\horrule{2pt} \\[0.5cm] % Thick bottom horizontal rule
}

\author{Daniel Bestard, Michael Cameron, Hans-Peter H{\"o}llwirth, Akhil Lohia} % Your name

\date{\normalsize\today} % Today's date or a custom date

\begin{document}
\maketitle


%%%%%%%%
% Problem 1 %
%%%%%%%%
\section{Inventory Control with Forecasts}


%%%%%%%%
% Problem 2 %
%%%%%%%%
\section{Inventory Pooling}
We want to compare the optimal expected cost between a decentralized and a pooled inventory system with $n$ locations. Let the demand at each location $i$ be independently, normally distributed with mean $\mu$ and variance $\sigma^2$, i.e. $D_1,...D_N \stackrel{iid}{\sim} N(\mu, \sigma^2)$. Then $\sum_{i=1}^N D_i \stackrel{d}{=} \sqrt{n}D_1 + \mu (n-\sqrt{n})$. \\


Let $h$ and $b$ denote the inventory holding cost and backorder cost, respectively. We already know that if $G(Q^*) = \mathbb{E}_D[h(Q^*-D)_+ + b(D-Q^*)_+]$ denotes the optimal expected cost for each location (with optimal order quantity $Q^* = \inf \left\{ Q \geq 0: \mathbb{P}\left(D_1 \leq Q \right) \geq \frac{b}{b+h} \right\}$), then the optimal expected cost in the decentralized inventory system is
$$G_D(Q^*) = \sum_{i=1}^N G(Q^*) = n G(Q^*)$$

To find the optimal expected cost in the pooled inventory system $G_P(Q_P^*)$, we first need to determine the optimal order quantity $Q_P^*$ under this system. 

\begin{align*}
Q_P^* &=  \inf \left\{ Q \geq 0: \mathbb{P}\left( \sum_{i=1}^N D_i \leq Q \right) \geq \frac{b}{b+h} \right\}\\
&=  \inf \left\{ Q \geq 0: \mathbb{P}\left( \sqrt{n}D_1 + \mu (n-\sqrt{n}) \leq Q \right) \geq \frac{b}{b+h} \right\}\\
&=  \inf \left\{ \sqrt{n}X + \mu (n-\sqrt{n}) \geq 0: \mathbb{P}\left(D_1 \leq X \right) \geq \frac{b}{b+h} \right\}\\
&=  \sqrt{n} \inf \left\{ X \geq 0: \mathbb{P}\left(D_1 \leq X \right) \geq \frac{b}{b+h} \right\} + \mu (n-\sqrt{n})\\
&=  \sqrt{n} Q^* + \mu (n-\sqrt{n})\\
\end{align*}

With this we can now determine optimal expected cost in the pooled inventory system $G_P(Q_P^*)$:

\begin{align*}
G_P(Q_P^*) &=  \mathbb{E}_{\{D\}}\left[h(Q_P^* - \sum_{i=1}^N D_i)_+ + b(\sum_{i=1}^N D_i - Q_P^*)_+\right]\\
&=  \mathbb{E}_{\{D\}}\big[h((\sqrt{n} Q^* + \mu (n-\sqrt{n})) - (\sqrt{n}D_1 + \mu (n-\sqrt{n})))_+ \\
&+ b((\sqrt{n}D_1 + \mu (n-\sqrt{n})) - (\sqrt{n} Q^* + \mu (n-\sqrt{n})))_+\big]\\
&=  \mathbb{E}_{\{D\}}\big[h(\sqrt{n} Q^* - \sqrt{n}D_1)_+ + b(\sqrt{n}D_1 - \sqrt{n} Q^* )_+\big]\\
&=  \sqrt{n} \cdot \mathbb{E}_{\{D\}}\big[h( Q^* - D_1)_+ + b(D_1 -  Q^* )_+\big]\\
&=  \sqrt{n} G(Q^*)\\
\end{align*}

It follows that
$$
\frac{G_D(Q^*)}{G_P(Q_P^*)} = \frac{n G(Q^*)}{\sqrt{n} G(Q^*)} = \frac{n}{\sqrt{n}} = \sqrt{n} 
$$
This result means that the expected optimal cost of the decentralized system is $\sqrt{n}$-times as large as the expected optimal cost of the pooled inventory system under the given assumptions.


%%%%%%%%
% Problem 3 %
%%%%%%%%
\section{An Investment Problem}
We want to find the optimal investment strategy in a situation where the investor can make $N$ sequential investment decisions, each resulting in one of two possible outcomes: Either (1) the invested money doubles (with probability $1/2 < p < 1$, or (2) the invested money is lost (with probability $1-p$). \\

Let $x_k$ denote the wealth at time $k$ (initial wealth $x_0$), let $u_k \in U_k(x_k) = [0, x_k]$ be the investment (decision) at time $k$ and let 
$$
w_k(u_k) = 
\begin{cases} 
2 u_k & \text{ with probability } p\\
0 & \text{ with probability } (1-p)\\
\end{cases}
$$
be the outcome of the investment at time $k$. 

First, note that the state transition has the following form:
$$
x_{k+1} = f(x_k,u_k,w_k) = x_k - u_k + w_k = 
\begin{cases} 
x_k + u_k & \text{ with probability } p\\
x_k - u_k & \text{ with probability } (1-p)\\
\end{cases}
$$ 

The DP algorithm has the form (note that we can consider the logarithm of the investor's wealth after the $N^{th}$ investment as the objective function without changing the optimal strategy):

\begin{align*}
J_N(x_N) &= \ln(x_N)\\
\\
J_k(x_k) &=  \max_{u_k \in U_k(x_k)} \mathbb{E}_{w_k} \left[ J_{k+1} (x_{k+1}) \right]\\
&=  \max_{u_k \in U_k(x_k)} \left[ p J_{k+1} (x_k + u_k) + (1-p) J_{k+1} (x_k - u_k)\right]\\
\end{align*}

We want to find the strategy that yields the maximum expected wealth at time $N$, given initial wealth $x_0$: $J_0(x_0)$. \\ First, consider the optimal strategy for a one-period investment horizon, i.e. $J_0(x_0) = J_{N-1}(x_{N-1}) = \max_{u_k \in U_k(x_k)} \left[ p \ln (x_k + u_k) + (1-p) \ln (x_k - u_k)\right]$. We can find the optimal investment strategy $u_{N-1}^*$ using first-order conditions:

\begin{align*}
\frac{\partial}{\partial u_{N-1}} J_{N-1}(x_{N-1}) &= 0\\
\frac{\partial}{\partial u_{N-1}} \left[ p \ln (x_{N-1} + u_{N-1}) + (1-p) \ln (x_{N-1} - u_{N-1})\right] &= 0\\
\frac{p}{x_{N-1} + u_{N-1}^*} - \frac{1-p}{x_{N-1} - u_{N-1}^*} &= 0\\
p(x_{N-1} - u_{N-1}^*) &= (1-p)(x_{N-1} + u_{N-1}^*)\\
u_{N-1}^* &= (2p-1)x_{N-1}\\
\end{align*}

It follows that $J_{N-1}(x_{N-1})$ has the form:
\begin{align*}
J_{N-1}(x_{N-1}) &=  \max_{u_{N-1}} \mathbb{E}_{w_{N-1}} \left[\ln J_{N} (x_{N}) \right]\\
&=  \max_{u_{N-1}} \left[ p \ln (x_{N-1} + u_{N-1}) + (1-p) \ln (x_{N-1} - u_{N-1})\right]\\
&=  p \ln (x_{N-1} + (2p-1)x_{N-1}) + (1-p) \ln (x_{N-1} - (2p-1)x_{N-1})\\
&=  p \ln (2p \cdot x_{N-1}) + (1-p) \ln ((2-2p) \cdot x_{N-1})\\
&=  p \ln (2p) + \ln(x_{N-1}) + (1-p) \ln (2-2p) + \ln(x_{N-1})\\
&=  p \ln (2p) - p\ln (2-2p) + \ln (2-2p) + \ln(x_{N-1})\\
&=  A_{N-1} + \ln(x_{N-1})\\
\end{align*}
where $A_{N-1} = p \ln (2p) - p\ln (2-2p) + \ln (2-2p)$ is independent of $x_{N-1}$. We see that $J_{N-1}(x_{N-1})$ contains the term $\ln(x_{N-1})$ and so the optimal strategy (known as "Kelly strategy") generalizes to all $k=0,1,..,(N-1)$ in the multi-period problem:
$$u_{k}^* = (2p-1)x_{k}$$
and therefore $J_k(x_k) = A_{k} + \ln(x_{k})$ for some $A_K$ independent of $x_k$.





%%%%%%%%
% Problem 4 %
%%%%%%%%
\section{Asset Selling with Maintenance Cost}


%%%%%%%%
% Problem 5 %
%%%%%%%%
\section{Scheduling Problem}
(a) \\
We solve this problem using list indexing. Let $L$ be the optimal order of answering the questions. Let $i$ and $j$ be the $k^{th}$ and $(k + 1)^{st}$ questions in the optimally ordered list L.
$$
L = (i_{0},...,i_{k-1},i,j,i_{k+2},...,i_{N-1})
$$
We can then calculate the expected return for answering the questions in this order.
\begin{align*}
\mathbb{E}[{reward~of~L}] = & \mathbb{E} [reward~of~\{i_{0},...,i_{k-1}\}] \\
+ & p_{i_{0}}···p_{i_{k-1}} p_{i}(R_{i}+p_{j}R_{j} -(1-p_{j})F_{j})-(1-p_{i})F_{i}  \\
+ & p_{i_{0}} ···p_{i_{k}} p_{i}p_{j} \mathbb{E}[reward~of~\{i_{k+2},...,i_{N-1}\}] \\
\end{align*}
Now we consider the is were quiestions $i$ and $j$ are interchanged.
$$
L^{\prime} = (i_{0},...,i_{k-1},j,i,i_{k+2},...,i_{N-1})
$$
Since $L$ is optimal, $\mathbb{E}[{reward~of~L}] \geq \mathbb{E}[{reward~of~L^{\prime}}]$
This is equivalent to 
\begin{align*}
p_{i}(R_{i}+p_{j}R_{j} -(1-p_{j})F_{j})-(1-p_{i})F_{i} &\geq p_{j}(R_{j}+p_{i}R_{i} -(1-p_{i})F_{i})-(1-p_{j})F_{j} \\
\implies \frac{p_{i}R_{i}-(1-p_{i})F_{i}}{1-p_{i}} &\geq \frac{p_{j}R_{j}-(1-p_{j})F_{j}}{1-p_{j}}
\end{align*}
So questions should be answered in order of decreasing $\frac{p_{i}R_{i}-(1-p_{i})F_{i}}{1-p_{i}}$
(b)
\end{document}















